# 咸鱼自动发货系统 (Node.js + React 重构版)

## 项目结构

* **server/**: 后端服务 (Express + TypeScript + Prisma + SQLite)

  * 提供 RESTful API (商品、卡密、订单)

  * 内置自动发货调度器 (Scheduler)

* **client/**: 前端界面 (React + TypeScript + Vite + TailwindCSS)

  * 仪表盘: 查看实时订单状态

  * 商品管理: 添加/编辑商品及自动发货关键词

  * 库存管理: 批量上传卡密

* **部署**: Docker + Docker Compose

## 运行指南

### 本地开发 (Windows/Mac/Linux)

需要打开两个终端分别运行前后端。

**Terminal 1 (后端):**

```bash
cd server
npm install
npx prisma generate
npx prisma db push
npm run dev
```

后端服务运行在 `http://localhost:3000`

**Terminal 2 (前端):**

```bash
cd client
npm install
npm run dev
```

前端界面运行在 `http://localhost:5173` (会自动代理 API 请求到后端)

### 服务器部署 (Ubuntu/Docker)

确保服务器已安装 Docker 和 Docker Compose。

1. 上传项目代码到服务器
2. 在项目根目录运行:

```bash
docker-compose up -d --build
```

1. 访问 `http://服务器IP:3000` 即可使用。

## 功能说明

1. **自动发货逻辑**: 后端 `server/src/scheduler/auto-delivery.ts` 中包含了一个 `MockDriver`。你需要实现真实的咸鱼 API/爬虫逻辑来替换 `checkOrders` 和 `sendMessage` 方法。
2. **数据存储**: 使用 SQLite 数据库，数据文件位于 `server/prisma/dev.db` (本地) 或挂载卷中 (Docker)。
3. **扩展性**: 系统设计为模块化，你可以轻松添加新的发货渠道或更改数据库 (Prisma 支持 MySQL/PostgreSQL)。

